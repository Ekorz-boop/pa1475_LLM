<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM RAG Pipeline Builder</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/blocks.css">
    <link rel="stylesheet" href="/static/css/block_content.css">
    <link rel="stylesheet" href="/static/css/sidebar.css">
    <link rel="stylesheet" href="/static/css/topbar.css">
    <link rel="stylesheet" href="/static/css/canvas.css">
    <link rel="stylesheet" href="/static/css/management_window.css">
    <link rel="stylesheet" href="/static/css/custom-block-modal.css">
    <link rel="stylesheet" href="/static/css/custom-blocks.css">
    <link rel="stylesheet" href="/static/css/dark-mode.css">
</head>

<body>
    <div id="app">
        <div id="notification-banner" class="notification-hidden">
            <span>‚ö†Ô∏è Ollama is not running. Some features will be unavailable.</span>
            <button id="open-management">Open System Management</button>
            <button class="close-notification">√ó</button>
        </div>
        
        <!-- Add sidebar toggle button -->
        <div id="sidebar-toggle">
            <img src="/static/images/icons/hamburger.svg" alt="Menu">
        </div>
        
        <div class="main-content">
            <div id="sidebar">
                <div class="main-menu">
                    <!-- Main Menu Content -->
                    <div class="menu-content" id="main-menu-content">
                        <div class="menu-section">
                            <div class="menu-item" data-menu="dashboard">
                                <img src="/static/images/icons/Dashboard.svg" alt="Dashboard">
                                <span>Dashboard</span>
                            </div>
                            <div class="menu-item" data-menu="blocks">
                                <img src="/static/images/icons/Blocks.svg" alt="Blocks">
                                <span>Blocks</span>
                            </div>
                            <div class="menu-item" data-menu="templates">
                                <img src="/static/images/icons/Templates.svg" alt="Templates">
                                <span>Templates</span>
                            </div>
                        </div>
                        
                        <div class="menu-section">
                            <div class="section-title">Theme</div>
                            <div class="theme-options">
                                <div class="theme-option" data-theme="light" title="Light mode">
                                    <span>‚òÄÔ∏è</span>
                                </div>
                                <div class="theme-option" data-theme="dark" title="Dark mode">
                                    <span>üåô</span>
                                </div>
                                <div class="theme-option" data-theme="system" title="System default">
                                    <span>üíª</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="menu-section">
                            <div class="section-title">Canvas Background</div>
                            <div class="bg-color-options">
                                <div class="bg-color-option" data-color="default" title="Default">
                                    <div class="color-preview default-bg"></div>
                                </div>
                                <div class="bg-color-option" data-color="white" title="White">
                                    <div class="color-preview white-bg"></div>
                                </div>
                                <div class="bg-color-option" data-color="light-blue" title="Light Blue">
                                    <div class="color-preview light-blue-bg"></div>
                                </div>
                                <div class="bg-color-option" data-color="light-yellow" title="Light Yellow">
                                    <div class="color-preview light-yellow-bg"></div>
                                </div>
                                <div class="bg-color-option" data-color="light-green" title="Light Green">
                                    <div class="color-preview light-green-bg"></div>
                                </div>
                                <div class="bg-color-option" data-color="light-purple" title="Light Purple">
                                    <div class="color-preview light-purple-bg"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bottom-menu">
                            <div class="menu-item" id="management-button" data-menu="system">
                                <img src="/static/images/icons/status.svg" alt="System Status">
                                <span>System Status</span>
                            </div>
                        </div>
                    </div>

                    <!-- Dashboard Content -->
                    <div class="menu-content" id="dashboard-content">
                        <div class="content-header">
                            <button class="back-button">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(0, 0, 0, 1);transform: ;msFilter:;"><path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"></path></svg>
                            </button>
                            <h3>Dashboard</h3>
                        </div>
                        <!-- Dashboard specific content -->
                    </div>

                    <!-- Blocks Content -->
                    <div class="menu-content" id="blocks-content">
                        <div class="content-header">
                            <button class="back-button">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(0, 0, 0, 1);transform: ;msFilter:;"><path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"></path></svg>
                            </button>
                            <h3>Blocks</h3>
                        </div>
                        <div class="search-container">
                            <input type="text" id="block-search" placeholder="Search blocks...">
                            <div class="search-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                </svg>
                            </div>
                        </div>
                        <div class="block-templates-container">
                            <div class="custom-blocks-message">
                                <button id="create-custom-block-btn" class="primary-btn">Create Custom Block</button>
                            </div>

                            <!-- Custom blocks section header -->
                            <div id="custom-blocks-section-header" class="custom-blocks-section-header" style="display: none;">
                                <span>Custom Blocks</span>
                                <div class="custom-blocks-divider"></div>
                            </div>

                            <!-- Custom blocks will appear here -->
                            <div id="custom-blocks-container"></div>
                        </div>
                    </div>

                    <!-- Templates Content -->
                    <div class="menu-content" id="templates-content">
                        <div class="content-header">
                            <button class="back-button">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(0, 0, 0, 1);transform: ;msFilter:;"><path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"></path></svg>
                            </button>
                            <h3>Templates</h3>
                        </div>
                        <!-- Templates specific content -->
                    </div>
                </div>
            </div>
            <div id="canvas">
                <button id="run-all" class="run-button" title="Run Pipeline">
                    <img src="/static/images/icons/run.svg" alt="Run Pipeline">
                </button>
                <div class="debug-mode-container" title="Enable to run partial pipelines for debugging">
                    <input type="checkbox" id="debug-mode">
                    <label for="debug-mode">Debug Mode</label>
                </div>
                <button id="export-pipeline" class="export-button" title="Export Pipeline">
                    <img src="/static/images/icons/export.svg" alt="Export Pipeline">
                </button>
                <div class="canvas-container">
                    <div class="canvas-grid"></div>
                    <svg id="connections"></svg>
                </div>
                <div class="mini-map">
                    <div class="mini-map-viewport"></div>
                </div>
                <div class="zoom-controls">
                    <button class="zoom-button" id="zoom-out">‚àí</button>
                    <div class="zoom-level">100%</div>
                    <button class="zoom-button" id="zoom-in">+</button>
                    <button class="zoom-button" id="zoom-fit" title="Reset zoom">‚ü≤</button>
                </div>
            </div>
        </div>

        <!-- Add the management panel HTML directly -->
        <div id="system-management" class="management-panel">
            <div class="management-header">
                <h2>System Status</h2>
                <button class="close-button">√ó</button>
            </div>

            <div class="management-content">
                <div class="status-items">
                    <div class="status-item">
                        <span class="status-label">Status:</span>
                        <span class="status-value" id="ollama-status">Checking...</span>
                    </div>
                </div>

                <div class="models-list">
                    <h3>Available Models</h3>
                    <div id="ollama-models">Loading models...</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JS -->
    <script src="/static/js/app.js"></script>
    <script src="/static/js/custom-block-handler.js"></script>

    <!-- Add this right after the body opening tag -->
    <div id="notification-system">
        <div id="toast-container"></div>
        <div id="modal-container"></div>
    </div>

    <!-- Add this before the closing body tag -->
    <div id="progress-modal" class="modal">
        <div class="modal-content">
            <h3 id="progress-title">Processing...</h3>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div id="progress-status">Initializing...</div>
        </div>
    </div>

    <style>
    
    /* Toast Notifications */
    #toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
    }

    .toast {
        background: white;
        border-radius: 4px;
        padding: 16px;
        margin-bottom: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 300px;
        max-width: 400px;
        animation: slideIn 0.3s ease;
    }

    .toast.success {
        border-left: 4px solid #4caf50;
    }

    .toast.error {
        border-left: 4px solid #f44336;
    }

    .toast.info {
        border-left: 4px solid #2196f3;
    }

    .toast.warning {
        border-left: 4px solid #ff9800;
    }

    @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }

    /* Progress Modal */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 9999;
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background: white;
        padding: 24px;
        border-radius: 8px;
        min-width: 400px;
        text-align: center;
    }

    .progress-bar {
        width: 100%;
        height: 8px;
        background: #eee;
        border-radius: 4px;
        margin: 16px 0;
        overflow: hidden;
    }

    .progress-fill {
        width: 0%;
        height: 100%;
        background: #4caf50;
        transition: width 0.3s ease;
    }

    #progress-status {
        color: #666;
        margin-top: 12px;
        font-size: 14px;
    }
    </style>
</body>
</html>
