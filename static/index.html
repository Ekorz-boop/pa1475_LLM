<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM RAG Pipeline Builder</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div id="app">
        <div id="notification-banner" class="notification-hidden">
            <span>⚠️ Ollama is not running. Some features will be unavailable.</span>
            <button id="open-management">Open System Management</button>
            <button class="close-notification">×</button>
        </div>
        <div id="top-bar">
            <button id="run-all" class="run-button">Run Pipeline</button>
            <button id="management-button" class="management-button">System Management</button>
        </div>
        <div class="main-content">
            <div id="sidebar">
                <h3>Blocks</h3>
                <!-- Document Loading Block Template -->
                <div class="block-template" draggable="true" data-block-type="file-loader">
                    <div class="block-drag-handle">File Loader</div>
                    <div class="block-content">
                        <div class="input-group">
                            <input type="file" class="file-input" accept=".txt,.pdf,.csv">
                        </div>
                        <div class="output-node" data-output="Document"></div>
                    </div>
                </div>

                <!-- Text Processing Block Template -->
                <div class="block-template" draggable="true" data-block-type="text-splitter">
                    <div class="block-drag-handle">Text Splitter</div>
                    <div class="block-content">
                        <div class="input-group">
                            <div class="input-node" data-input="Text"></div>
                            <input type="number" class="chunk-size" value="1000" min="100" step="100">
                            <span>chunk size</span>
                        </div>
                        <div class="output-node" data-output="Chunks"></div>
                    </div>
                </div>

                <!-- Display Block Template -->
                <div class="block-template" draggable="true" data-block-type="display">
                    <div class="block-drag-handle">Display</div>
                    <div class="block-content">
                        <div class="input-group">
                            <div class="input-node" data-input="Input"></div>
                        </div>
                        <div class="output-display">No input</div>
                    </div>
                </div>

                <!-- New Custom Block Template -->
                <div class="block-template" draggable="true" data-block-type="custom-block">
                    <div class="block-drag-handle">Custom Block</div>
                    <div class="block-content">
                        <div class="input-group">
                            <div class="input-node" data-input="CustomInput"></div>
                        </div>
                        <div class="output-node" data-output="CustomOutput"></div>
                    </div>
                </div>

                <!-- String Addition Block Template -->
                <div class="block-template" draggable="true" data-block-type="string-addition">
                    <div class="block-drag-handle">String Addition</div>
                    <div class="block-content">
                        <div class="input-group">
                            <div class="input-node" data-input="Text1"></div>
                            <div class="input-node" data-input="Text2"></div>
                        </div>
                        <div class="output-node" data-output="Result"></div>
                    </div>
                </div>

                <!-- AI Model Block Template -->
                <div class="block-template" draggable="true" data-block-type="ai-model">
                    <div class="block-drag-handle">AI Model</div>
                    <div class="block-content">
                        <div class="input-group">
                            <div class="input-node" data-input="Text"></div>
                        </div>
                        <select class="model-selector">
                            <option value="tinyllama">TinyLlama</option>
                        </select>
                        <div class="output-node" data-output="Response"></div>
                    </div>
                </div>
            </div>
            <div id="canvas">
                <div class="canvas-container">
                    <div class="canvas-grid"></div>
                    <svg id="connections"></svg>
                </div>
                <div class="zoom-controls">
                    <button class="zoom-button" id="zoom-in">+</button>
                    <div class="zoom-level">100%</div>
                    <button class="zoom-button" id="zoom-out">−</button>
                    <button class="zoom-button" id="zoom-fit">⟲</button>
                </div>
            </div>
        </div>

        <!-- Add the management panel HTML directly -->
        <div id="system-management" class="management-panel">
            <div class="management-header">
                <h2>System Status</h2>
                <button class="close-button">×</button>
            </div>
            
            <div class="management-content">
                <div class="status-items">
                    <div class="status-item">
                        <span class="status-label">Status:</span>
                        <span class="status-value" id="ollama-status">Checking...</span>
                    </div>
                </div>

                <div class="models-list">
                    <h3>Available Models</h3>
                    <div id="ollama-models">Loading models...</div>
                </div>
            </div>
        </div>
    </div>
    <script src="/static/app.js"></script>
</body>
</html>
